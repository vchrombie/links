<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
</head>
<body>
  <script>
    const isUrl = str => {
      // This regular expression matches URLs
      const pattern = /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*(?:\?([^#]*))?(?:#(.*))?$/;
      return pattern.test(str);
    };

    const currentUrl = window.location.pathname;
    const parts = currentUrl.split('/');
    const number = parts[parts.length - 1];

    const url = `https://api.github.com/repos/vchrombie/links/issues/${number}`;

    fetch(url)
      .then(response => response.json())
      .then(data => {
        const title = data.title;
        if (isUrl(title)) {
          // The title is a URL
          window.open(title, '_self');
        } else {
          // The title is not a URL
          window.open('https://vchrombie.github.io/links', '_self');
        }
      })
      .catch(error => {
        // Handle the error by redirecting to the vchrombie.github.io/links page
        window.location.href = 'https://vchrombie.github.io/links';
      });
  </script>
</body>
</html>
